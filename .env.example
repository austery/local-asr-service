# ====================================================================================
# Local ASR Service - 环境变量配置示例
# ====================================================================================
# 复制此文件为 .env 并修改配置
# cp .env.example .env
# ====================================================================================

# ====================================
# 引擎配置 (Engine Configuration)
# ====================================

# 引擎类型: funasr (FunASR/SenseVoice) 或 mlx (MLX Audio)
ENGINE_TYPE=funasr

# 通用模型 ID（优先级最高，会覆盖下面的引擎特定配置）
# MODEL_ID=mlx-community/Qwen3-ASR-1.7B-4bit

# FunASR 引擎默认模型
FUNASR_MODEL_ID=iic/SenseVoiceSmall

# MLX 引擎默认模型（推荐：Qwen3-ASR，速度快且稳定）
MLX_MODEL_ID=mlx-community/Qwen3-ASR-1.7B-4bit

# ====================================
# 服务配置 (Service Configuration)
# ====================================

# 服务监听地址
HOST=0.0.0.0

# 服务监听端口
PORT=50070

# 最大队列深度（防止 OOM）
MAX_QUEUE_SIZE=50

# ====================================
# 日志配置 (Logging Configuration)
# ====================================

# 日志级别: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# ====================================
# 音频处理配置 (Audio Processing)
# ====================================
# 仅 MLX 引擎使用（FunASR 无时长限制）

# 最大音频时长（分钟）
# Qwen3-ASR 推荐设置为 50 分钟，超长音频会自动切片处理
MAX_AUDIO_DURATION_MINUTES=50

# 静音检测配置（用于智能切片）
SILENCE_THRESHOLD_SEC=0.5        # 最小静音时长（秒）
SILENCE_NOISE_DB=-30dB           # 噪音阈值（越低越严格）

# 音频归一化配置
AUDIO_SAMPLE_RATE=16000          # 采样率（Whisper 标准）
AUDIO_BITRATE=64k                # 比特率（语音压缩）

# 重叠切片配置（静音检测失败时的 fallback 策略）
CHUNK_OVERLAP_SECONDS=15         # 切片重叠时长（秒）

# ====================================
# 支持的 MLX 模型列表 (参考)
# ====================================
# 使用时取消注释并设置 ENGINE_TYPE=mlx 和 MODEL_ID

# 🎯 阿里 Qwen3-ASR（推荐，速度快且稳定）
# MODEL_ID=mlx-community/Qwen3-ASR-1.7B-4bit        # 4-bit 量化版（推荐，约 2 GB）
# MODEL_ID=mlx-community/Qwen3-ASR-1.7B-8bit        # 8-bit 量化版（约 3 GB）

# OpenAI Whisper 系列
# MODEL_ID=mlx-community/whisper-large-v3-turbo-asr-fp16    # Turbo 版（约 1.5 GB）
# MODEL_ID=mlx-community/whisper-large-v3                   # Large V3（约 3 GB）

# NVIDIA Parakeet（仅英文）
# MODEL_ID=mlx-community/parakeet-tdt-0.6b-v2       # 0.6B 参数（约 600 MB）

# ====================================
# 模型存储位置 (Model Storage Paths)
# ====================================
# 模型会自动下载到以下位置（无需手动配置）：
# 
# FunASR 模型:      ~/.cache/modelscope/hub/models/iic/
# MLX Audio 模型:   ~/.cache/huggingface/hub/
#
# 查看已下载模型：
#   ls -lh ~/.cache/modelscope/hub/models/iic/
#   ls -lh ~/.cache/huggingface/hub/
#
# 清理模型缓存：
#   rm -rf ~/.cache/modelscope/hub/models/iic/SenseVoiceSmall
#   rm -rf ~/.cache/huggingface/hub/models--mlx-community*
